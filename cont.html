<!doctype html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, maximum-scale=1.0, user-scalable=no">
  <title>controller</title>
  <script src="http://cdn.mlkcca.com/v0.2.8/milkcocoa.js"></script>
  <script src="libs/jquery.min.js"></script>
</head>
<body>

<div id="left" onclick="sendControl(-10);">←</div>
<div id="right" onclick="sendControl(10);">→</div>


<style type="text/css">
<!--

html,body {
  height:100%;
  width:100%;
  margin: 0;
}
div {
  width: 49%;
  height: 55%;
  display: inline-block;
  text-align: center;
  font-size: 100px;
  padding-top: 40%;
}

#left {
  background-color: #FF6666;
}

#right {
  background-color: #6666FF;
}

//-->
</style>


<script type="text/javascript">
var milkcocoa = new MilkCocoa("https://io-oi8qondb6.mlkcca.com/");
var potisionDataStore = milkcocoa.dataStore("position");
var token = "";

function sendControl(value){
  potisionDataStore.push({mv: value, token : token},function(data){
    console.log("milkcocoa送信完了!");
  });
}

//URLのtokenを同期用にセットする
window.onload = function(){
  token = getQueryString().token;
  console.log(getQueryString().token);

  //接続確認を送る
  sendControl(0);
}

//URLの文字列を取得
function getQueryString(){
    var result = {};
    if( 1 < window.location.search.length ){
        var query = window.location.search.substring( 1 );
        var parameters = query.split( '&' );
        for( var i = 0; i < parameters.length; i++ ){
            var element = parameters[ i ].split( '=' );
            var paramName = decodeURIComponent( element[ 0 ] );
            var paramValue = decodeURIComponent( element[ 1 ] );
            result[ paramName ] = paramValue;
        }
    }
    return result;
}
</script> 
</body>
</html>